# cds_insertion

cds\_insertion is intended to add CDS features to transcriptome annotations lacking them (referred to later as the "raw" transcriptome annotation) (e.g. a GTF file generated by a transcript assembler such as stringtie (https://ccb.jhu.edu/software/stringtie/).  cds\_insertion accomplishes this by taking as input the raw transcriptome annotation as well as a separate transcriptome annotation that includes CDS features (e.g. GENCODE https://www.gencodegenes.org/), identifying overlaps between the raw transcriptome exons and annotated CDS start codons, and then translating the raw transcriptome transcripts (_in silico_) from the overlapping annotated start codons. Future versions will accept a bed file of start codon coordinates in lieu of a full annotation. The idea is to restrict inserted CDS features to those derived from start codons to those for which there is strong evidence of utilization (e.g. conservation, known protein sequences, evidence from Ribo-seq or similar) rather than inserting another layer of arbitrary decisions by performing de novo CDS predictions. cds\_insertion additionally identifies a number of transcript properties derived from the presence/properties of the CDS such as the UTR lengths and the presence/absence of a premature termination codon.

usage: cds_insertion.py [-h] --transcript_gtf TRANSCRIPT_GTF  
                        --transcript_fasta TRANSCRIPT_FASTA --annotation_gtf
                        ANNOTATION_GTF [--CCDS] --outdir OUTDIR
                        [--bigGenePred_as_path BIGGENEPRED_AS_PATH]
                        [--gtfToGenePred_path GTFTOGENEPRED_PATH]
                        [--genePredToBigGenePred_path GENEPREDTOBIGGENEPRED_PATH]
                        [--bedToBigBed_path BEDTOBIGBED_PATH]
                        [--chrNameLength_path CHRNAMELENGTH_PATH]
                        [--make_bigBed] [--ptc_dist PTC_DIST]

optional arguments:
  -h, --help            show this help message and exit  
  --transcript_gtf TRANSCRIPT_GTF  
                        Input transcript gtf filename  
  --transcript_fasta TRANSCRIPT_FASTA  
                        Input transcript fasta (assumes generation with   
                        gffread)  
  --annotation_gtf ANNOTATION_GTF  
                        Input gtf filename that contains CDS (preferably CCDS)
                        features  
  --CCDS                If set, CDS used will be restricted to CCDS.  
  --outdir OUTDIR       Path for output files  
  --bigGenePred_as_path BIGGENEPRED_AS_PATH  
                        Path to bigGenePred.as file
  --gtfToGenePred_path GTFTOGENEPRED_PATH  
                        Path to gtfToGenePred exe  
  --genePredToBigGenePred_path GENEPREDTOBIGGENEPRED_PATH  
                        Path to genePredToBigGenePred exe  
  --bedToBigBed_path BEDTOBIGBED_PATH  
                        Path to bedToBigBed exe  
  --chrNameLength_path CHRNAMELENGTH_PATH  
                        Path to chrNameLength file    
  --make_bigBed         If set, will attempt to use Kent utils to output  
                        bigbed file from gtfs. Requires chrNameLength_path and
                        bigGenePred_as_path to be set. If Kent utils are not
                        in PATH, set the paths to the executables as well.  
  --ptc_dist PTC_DIST   Set minimum PTC distance required for transcript to be  
                        considered putative NMD substrate. default = 55  
